(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{1386:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var a=s(5155),r=s(2115),n=s(1665),i=s(4423),o=s(7168),d=s(3999),l=s(4416),u=s(5339),c=s(4616),m=s(714),p=s(3008),h=s(7777),x=s(8145),g=s(9840),f=s(5784),v=s(2714),y=s(9474),b=s(6645);function w(e){let{open:t,onOpenChange:s,employeeId:n,day:i,onSubmit:d,existingDropouts:l,formatTime:c}=e,[m,p]=(0,r.useState)(540),[h,x]=(0,r.useState)(60),[w,j]=(0,r.useState)(""),[N,D]=(0,r.useState)(null),S=[];for(let e=0;e<24;e++)for(let t=0;t<60;t+=15){let s=60*e+t;S.push({value:s,label:c(s)})}let q=e=>1440-e,A=()=>{let e=m+h;return e>1440?"Dropouts cannot span across days. Please adjust the duration.":l.some(t=>m<t.startTime+t.duration&&e>t.startTime)?"This dropout overlaps with an existing dropout request. Please choose a different time.":null},T=(e=>{let t=q(e),s=[],a=Math.min(t,240);for(let e=0;e<24;e++)for(let t=0;t<60;t+=15){var r,n;if(0===e&&0===t)continue;let i=60*e+t;if(i>a)break;s.push({value:i,label:(r=e,n=t,0===r?"".concat(n," minutes"):0===n?"".concat(r," ").concat(1===r?"hour":"hours"):"".concat(r," ").concat(1===r?"hour":"hours"," ").concat(n," minutes"))})}return s})(m);return(0,a.jsx)(g.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(g.Cf,{className:"sm:max-w-[500px]",children:[(0,a.jsx)(g.c7,{children:(0,a.jsx)(g.L3,{children:"Request Dropout"})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"start-time",children:"Start Time"}),(0,a.jsxs)(f.l6,{value:m.toString(),onValueChange:e=>{let t=Number(e);p(t);let s=Math.min(q(t),240);h>s&&x(s),D(A())},children:[(0,a.jsx)(f.bq,{id:"start-time",children:(0,a.jsx)(f.yv,{placeholder:"Select start time"})}),(0,a.jsx)(f.gC,{className:"max-h-[300px]",children:S.map(e=>(0,a.jsx)(f.eb,{value:e.value.toString(),children:e.label},"start-".concat(e.value)))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"duration",children:"Duration"}),(0,a.jsxs)(f.l6,{value:h.toString(),onValueChange:e=>{x(Number(e)),D(A())},children:[(0,a.jsx)(f.bq,{id:"duration",children:(0,a.jsx)(f.yv,{placeholder:"Select duration"})}),(0,a.jsx)(f.gC,{className:"max-h-[300px]",children:T.map(e=>(0,a.jsx)(f.eb,{value:e.value.toString(),children:e.label},"duration-".concat(e.value)))})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"reason",children:"Reason for Dropout"}),(0,a.jsx)(y.T,{id:"reason",value:w,onChange:e=>{j(e.target.value)},placeholder:"Please explain why you need to dropout from your shift",className:"min-h-[100px]"})]}),N&&(0,a.jsxs)(b.Fc,{variant:"destructive",children:[(0,a.jsx)(u.A,{className:"h-4 w-4"}),(0,a.jsx)(b.TN,{children:N})]})]}),(0,a.jsxs)(g.Es,{children:[(0,a.jsx)(o.$,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,a.jsx)(o.$,{onClick:()=>{if(!w.trim()){D("Please provide a reason for your dropout request.");return}let e=A();if(e){D(e);return}d({startTime:m,duration:h,reason:w.trim()}),p(540),x(60),j(""),D(null)},disabled:!w.trim()||!!N,children:"Submit Request"})]})]})})}function j(e){let{employeeId:t,employeeName:s,dropoutRequests:n,assignments:i,weekStartDate:g,onDropoutRequestSubmit:f,onDropoutRequestCancel:v}=e,[y,b]=(0,r.useState)(!1),[j,N]=(0,r.useState)(0),[D,S]=(0,r.useState)(null),q=Array.from({length:7},(e,t)=>{let s=(0,m.f)(g,t);return{name:(0,p.GP)(s,"EEEE"),date:(0,p.GP)(s,"MMM d"),fullDate:s}}),A=e=>{let t=Math.floor(e/60);return"".concat(t%12==0?12:t%12,":").concat((e%60).toString().padStart(2,"0")).concat(t<12?"am":"pm")},T=e=>{switch(e){case"approved":return"bg-green-500 hover:bg-green-600";case"rejected":return"bg-red-500 hover:bg-red-600";default:return"bg-yellow-500 hover:bg-yellow-600"}},I=e=>{N(e),b(!0)};return(0,a.jsx)(h.Bc,{children:(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 border-b",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold",children:[s,"'s Dropout Requests"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Submit requests for times you cannot work your scheduled shifts"})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 border-b",children:q.map((e,t)=>(0,a.jsxs)("div",{className:"p-2 text-center border-r last:border-r-0",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.date})]},e.name))}),(0,a.jsx)("div",{className:"grid grid-cols-7",children:q.map((e,s)=>{let r=n.filter(e=>e.day===s),m=i.filter(e=>e.day===s);return(0,a.jsxs)("div",{className:"border-r last:border-r-0 min-h-[200px] relative p-2",children:[m.map(e=>{let t=e.startTime/1440*100,s=e.duration/1440*100;return(0,a.jsx)("div",{className:"absolute bg-gray-200 opacity-30",style:{left:"".concat(t,"%"),width:"".concat(s,"%"),top:"0",height:"100%",zIndex:"1"}},e.id)}),r.map(e=>{let t=e.startTime/1440*100,s=e.duration/1440*100,r=e.startTime+e.duration;return e.id,(0,a.jsxs)(h.m_,{children:[(0,a.jsx)(h.k$,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,d.cn)("absolute flex items-center justify-center text-[10px] font-medium text-white cursor-pointer transition-all","approved"===e.status?"bg-red-500":"rejected"===e.status?"bg-gray-500":"bg-yellow-500","hover:opacity-80"),style:{left:"".concat(t,"%"),width:"".concat(s,"%"),top:"50%",transform:"translateY(-50%)",height:"24px",zIndex:"10",minWidth:"10px",maxWidth:"".concat(100-t,"%")},onMouseEnter:()=>S(e.id),onMouseLeave:()=>S(null),children:["pending"===e.status&&(0,a.jsx)("button",{className:"absolute -top-1 -right-1 bg-red-500 rounded-full p-0.5",onClick:t=>{t.stopPropagation(),v(e.id)},children:(0,a.jsx)(l.A,{className:"h-3 w-3"})}),(0,a.jsx)(x.E,{className:(0,d.cn)("absolute -top-5 left-0 text-[9px] py-0 px-1",T(e.status)),children:e.status})]})}),(0,a.jsx)(h.ZI,{className:"bg-red-100/90 border-red-200 text-red-800 max-w-[250px]",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 font-medium",children:[(0,a.jsx)(u.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[A(e.startTime),"-",A(r)]})]}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"font-medium",children:"Reason:"})," ",e.reason]}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"font-medium",children:"Status:"})," ",e.status]}),e.reviewNotes&&(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"font-medium",children:"Notes:"})," ",e.reviewNotes]})]})})]},e.id)}),(0,a.jsxs)(o.$,{variant:"outline",size:"sm",className:"absolute bottom-2 right-2",onClick:()=>I(s),children:[(0,a.jsx)(c.A,{className:"h-3 w-3 mr-1"})," Request"]})]},"".concat(t,"-").concat(s))})}),y&&(0,a.jsx)(w,{open:y,onOpenChange:b,employeeId:t,day:j,onSubmit:e=>{f({employeeId:t,day:j,startTime:e.startTime,duration:e.duration,reason:e.reason}),b(!1)},existingDropouts:n.filter(e=>e.day===j).map(e=>({startTime:e.startTime,duration:e.duration})),formatTime:A})]})})}var N=s(6874),D=s.n(N),S=s(7550),q=s(4627);function A(){let[e,t]=(0,r.useState)((0,i.k)(new Date,{weekStartsOn:1})),[s,d]=(0,r.useState)([]),[l,u]=(0,r.useState)([]),[c,m]=(0,r.useState)({id:"9",name:"Loading...",location:""}),[p,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{h(!0);try{let e=await q.i.getEmployeeById("9");e.status.success&&e.data.items.length>0&&m(e.data.items[0]);let t=await q.i.getDropoutRequests({employeeId:"9"});t.status.success&&d(t.data.items);let s=await q.i.getAssignmentsForEmployee("9");s.status.success&&u(s.data.items)}catch(e){console.error("Error fetching data:",e)}finally{h(!1)}})()},[]);let x=async e=>{try{let t=await q.i.createDropoutRequest(e);t.status.success&&t.data.items.length>0&&d([...s,t.data.items[0]])}catch(e){console.error("Error submitting dropout request:",e)}},g=async e=>{try{var t;let a=await q.i.cancelDropoutRequest(e);a.status.success&&(null===(t=a.data.items[0])||void 0===t?void 0:t.success)&&d(s.filter(t=>t.id!==e))}catch(e){console.error("Error canceling dropout request:",e)}};return p?(0,a.jsx)("div",{className:"container mx-auto py-8",children:(0,a.jsx)("div",{className:"text-center py-12",children:"Loading..."})}):(0,a.jsxs)("div",{className:"container mx-auto py-8",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(D(),{href:"/schedule",children:(0,a.jsxs)(o.$,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),"Back to Schedule"]})})}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"My Dropout Requests"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Request time off from your scheduled shifts"})]}),(0,a.jsx)(n.I,{currentDate:e,onWeekChange:(e,s)=>{t(e),console.log("Week changed: ".concat(e.toDateString()," to ").concat(s.toDateString()))}}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)(j,{employeeId:c.id,employeeName:c.name,dropoutRequests:s,assignments:l,weekStartDate:e,onDropoutRequestSubmit:x,onDropoutRequestCancel:g})}),(0,a.jsxs)("div",{className:"mt-6 bg-white p-4 rounded-lg border",children:[(0,a.jsx)("h2",{className:"text-lg font-medium mb-2",children:"About Dropout Requests"}),(0,a.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Pending"}),": Your request is waiting for administrator review"]})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Approved"}),": Your request has been approved"]})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Rejected"}),": Your request has been rejected"]})]})]}),(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"You can cancel pending requests, but once a request is approved or rejected, it cannot be changed. Please submit dropout requests at least 48 hours in advance when possible."})]})]})}},3600:(e,t,s)=>{Promise.resolve().then(s.bind(s,1386))},4627:(e,t,s)=>{"use strict";s.d(t,{i:()=>d});var a=s(1368);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Operation successful";return{status:{success:!0,message:t,"":null,timestamp:Date.now().toString()+Math.floor(1e3*Math.random()).toString().padStart(3,"0")},data:{items:e}}}let n=[{id:"1",name:"John Doe",location:"North"},{id:"2",name:"Jane Smith",location:"North"},{id:"3",name:"Bob Johnson",location:"South"},{id:"4",name:"Alice Williams",location:"South"},{id:"5",name:"Mike Brown",location:"East"},{id:"6",name:"Sarah Davis",location:"East"},{id:"7",name:"Tom Wilson",location:"West"},{id:"8",name:"Emily Taylor",location:"West"},{id:"9",name:"David Miller",location:"Central"},{id:"10",name:"Lisa Anderson",location:"Central"}],i=[{id:"dr1",employeeId:"1",day:0,startTime:660,duration:60,status:"approved",reason:"Doctor's appointment",submittedAt:new Date(Date.now()-6048e5),reviewedAt:new Date(Date.now()-432e6),reviewedBy:"Admin",reviewNotes:"Approved as requested"},{id:"dr2",employeeId:"1",day:2,startTime:600,duration:120,status:"pending",reason:"Family emergency",submittedAt:new Date(Date.now()-1728e5)},{id:"dr3",employeeId:"2",day:1,startTime:840,duration:90,status:"pending",reason:"Personal appointment",submittedAt:new Date(Date.now()-3456e5)},{id:"dr4",employeeId:"3",day:3,startTime:540,duration:180,status:"rejected",reason:"Vacation day",submittedAt:new Date(Date.now()-5184e5),reviewedAt:new Date(Date.now()-3456e5),reviewedBy:"Admin",reviewNotes:"Request submitted too late"},{id:"dr5",employeeId:"4",day:4,startTime:780,duration:120,status:"pending",reason:"Medical procedure",submittedAt:new Date(Date.now()-864e5)},{id:"dr6",employeeId:"9",day:0,startTime:900,duration:60,status:"approved",reason:"Doctor's appointment",submittedAt:new Date(Date.now()-6048e5),reviewedAt:new Date(Date.now()-432e6),reviewedBy:"Admin",reviewNotes:"Approved as requested"},{id:"dr7",employeeId:"9",day:2,startTime:840,duration:120,status:"pending",reason:"Family emergency",submittedAt:new Date(Date.now()-1728e5)},{id:"dr8",employeeId:"9",day:5,startTime:600,duration:90,status:"rejected",reason:"Personal appointment",submittedAt:new Date(Date.now()-3456e5),reviewedAt:new Date(Date.now()-2592e5),reviewedBy:"Admin",reviewNotes:"Insufficient staffing for this time period"}],o=[{id:"a21",employeeId:"9",day:0,startTime:780,duration:480},{id:"a22",employeeId:"9",day:2,startTime:795,duration:465},{id:"a22b",employeeId:"9",day:5,startTime:540,duration:240},{id:"a22c",employeeId:"9",day:5,startTime:900,duration:240}],d={getDropoutRequests:async e=>{await new Promise(e=>setTimeout(e,300));let t=[...i];return(null==e?void 0:e.employeeId)&&(t=t.filter(t=>t.employeeId===e.employeeId)),(null==e?void 0:e.status)&&(t=t.filter(t=>t.status===e.status)),r(t,"Dropout requests retrieved successfully")},createDropoutRequest:async e=>{await new Promise(e=>setTimeout(e,500));let t={id:(0,a.A)(),employeeId:e.employeeId,day:e.day,startTime:e.startTime,duration:e.duration,reason:e.reason,status:"pending",submittedAt:new Date};return i.push(t),r([t],"Dropout request created successfully")},cancelDropoutRequest:async e=>{await new Promise(e=>setTimeout(e,300));let t=i.findIndex(t=>t.id===e),s=!1;return -1!==t&&"pending"===i[t].status&&(i.splice(t,1),s=!0),r([{id:e,success:s}],s?"Dropout request cancelled successfully":"Failed to cancel dropout request")},updateDropoutRequest:async(e,t)=>{await new Promise(e=>setTimeout(e,500));let s=i.findIndex(t=>t.id===e);return -1!==s?(i[s]={...i[s],status:t.status,reviewedAt:new Date,reviewedBy:"Admin",reviewNotes:t.reviewNotes||("approved"===t.status?"Approved as requested":"Request rejected")},r([i[s]],"Dropout request ".concat(t.status," successfully"))):{status:{success:!1,message:"Dropout request not found","":null,timestamp:Date.now().toString()+Math.floor(1e3*Math.random()).toString().padStart(3,"0")},data:{items:[]}}},getAssignmentsForEmployee:async e=>{await new Promise(e=>setTimeout(e,300));let t=[];return"9"===e&&(t=o),r(t,"Assignments retrieved successfully")},getEmployeeById:async e=>{await new Promise(e=>setTimeout(e,200));let t=n.find(t=>t.id===e);return t?r([t],"Employee retrieved successfully"):{status:{success:!1,message:"Employee not found","":null,timestamp:Date.now().toString()+Math.floor(1e3*Math.random()).toString().padStart(3,"0")},data:{items:[]}}},getAllEmployees:async()=>(await new Promise(e=>setTimeout(e,300)),r(n,"Employees retrieved successfully"))}},7550:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8145:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});var a=s(5155);s(2115);var r=s(2085),n=s(3999);let i=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...r})}},9474:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var a=s(5155),r=s(2115),n=s(3999);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});i.displayName="Textarea"}},e=>{var t=t=>e(e.s=t);e.O(0,[653,965,902,441,684,358],()=>t(3600)),_N_E=e.O()}]);